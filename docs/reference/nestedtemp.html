<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nestedness Indices for Communities of Islands or Patches — nestedtemp • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nestedness Indices for Communities of Islands or Patches — nestedtemp"><meta property="og:description" content="Patches or local communities are regarded as nested if they all could
  be subsets of the same community. In general, species poor communities
  should be subsets of species rich communities, and rare species should
  only occur in species rich communities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nestedness Indices for Communities of Islands or Patches</h1>
    
    <div class="hidden name"><code>nestedtemp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Patches or local communities are regarded as nested if they all could
  be subsets of the same community. In general, species poor communities
  should be subsets of species rich communities, and rare species should
  only occur in species rich communities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">nestedchecker</span><span class="op">(</span><span class="va">comm</span><span class="op">)</span>
<span class="fu">nestedn0</span><span class="op">(</span><span class="va">comm</span><span class="op">)</span>
<span class="fu">nesteddisc</span><span class="op">(</span><span class="va">comm</span>, niter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">nestedtemp</span><span class="op">(</span><span class="va">comm</span>, <span class="va">...</span><span class="op">)</span>
<span class="fu">nestednodf</span><span class="op">(</span><span class="va">comm</span>, order <span class="op">=</span> <span class="cn">TRUE</span>, weighted <span class="op">=</span> <span class="cn">FALSE</span>, wbinary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">nestedbetasor</span><span class="op">(</span><span class="va">comm</span><span class="op">)</span>
<span class="fu">nestedbetajac</span><span class="op">(</span><span class="va">comm</span><span class="op">)</span>
<span class="co"># S3 method for nestedtemp</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, kind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span>, <span class="st">"incidence"</span><span class="op">)</span>,
    col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,  names <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for nestednodf</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"red"</span>, names <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>comm</dt>
<dd><p>Community data.</p></dd>
<dt>niter</dt>
<dd><p>Number of iterations to reorder tied columns.</p></dd>
<dt>x</dt>
<dd><p>Result object for a <code>plot</code>.</p></dd>
<dt>col</dt>
<dd><p>Colour scheme for matrix temperatures.</p></dd>
<dt>kind</dt>
<dd><p>The kind of plot produced.</p></dd>
<dt>names</dt>
<dd><p>Label columns and rows in the plot using names in <code>comm</code>.
    If it is a logical vector of length 2, row and column labels are
    returned accordingly.</p></dd>
<dt>order</dt>
<dd><p>Order rows and columns by frequencies.</p></dd>
<dt>weighted</dt>
<dd><p>Use species abundances as weights of interactions.</p></dd>
<dt>wbinary</dt>
<dd><p>Modify original method so that binary data give the same
    result in weighted and and unweighted analysis.</p></dd>
<dt>...</dt>
<dd><p>Other arguments to functions.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The nestedness functions evaluate alternative indices of nestedness.
  The functions are intended to be used together with Null model
  communities and used as an argument in <code><a href="oecosimu.html">oecosimu</a></code> to analyse
  the non-randomness of results.</p>
<p>Function <code>nestedchecker</code> gives the number of checkerboard units,
  or 2x2 submatrices where both species occur once but on different
  sites (Stone &amp; Roberts 1990).</p>
<p>Function <code>nestedn0</code> implements
  nestedness measure N0 which is the number of absences from the sites
  which are richer than the most pauperate site species occurs
  (Patterson &amp; Atmar 1986).</p>
<p>Function <code>nesteddisc</code> implements discrepancy index which is the
  number of ones that should be shifted to fill a row with ones in a
  table arranged by species frequencies (Brualdi &amp; Sanderson
  1999). The original definition arranges species (columns) by their
  frequencies, but did not have any method of handling tied
  frequencies.  The <code>nesteddisc</code> function tries to order tied
  columns to minimize the discrepancy statistic but this is rather
  slow, and with a large number of tied columns there is no guarantee
  that the best ordering was found (argument <code>niter</code> gives the
  maximum number of tried orders). In that case a warning of tied
  columns will be issued.</p>
<p>Function <code>nestedtemp</code> finds the matrix temperature which is
  defined as the sum of “surprises” in arranged matrix.  In
  arranged unsurprising matrix all species within proportion given by
  matrix fill are in the upper left corner of the matrix, and the
  surprise of the absence or presences is the diagonal distance from the
  fill line (Atmar &amp; Patterson 1993). Function tries to pack species and
  sites to a low temperature (Rodríguez-Gironés
  &amp; Santamaria 2006), but this is an iterative procedure, and the
  temperatures usually vary among runs.  Function <code>nestedtemp</code> also
  has a <code>plot</code> method which can display either incidences or
  temperatures of the surprises. Matrix temperature was rather vaguely
  described (Atmar &amp; Patterson 1993), but
  Rodríguez-Gironés &amp; Santamaria (2006) are
  more explicit and their description is used here. However, the results
  probably differ from other implementations, and users should be
  cautious in interpreting the results. The details of calculations are
  explained in the <code><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></code> <em>Design decisions and
  implementation</em> that you can read using functions
  <code><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></code>. Function
  <code>nestedness</code> in the <span class="pkg">bipartite</span> package is
  a direct port of the BINMATNEST programme of
  Rodríguez-Gironés &amp; Santamaria (2006).</p>
<p>Function <code>nestednodf</code> implements a nestedness metric based on
  overlap and decreasing fill (Almeida-Neto et al., 2008). Two basic
  properties are required for a matrix to have the maximum degree of
  nestedness according to this metric: (1) complete overlap of 1's
  from right to left columns and from down to up rows, and (2)
  decreasing marginal totals between all pairs of columns and all
  pairs of rows. The nestedness statistic is evaluated separately for
  columns (<code>N columns</code>) for rows (<code>N rows</code>) and combined for
  the whole matrix (<code>NODF</code>).  If you set <code>order = FALSE</code>,
  the statistic is evaluated with the current matrix ordering allowing
  tests of other meaningful hypothesis of matrix structure than
  default ordering by row and column totals (breaking ties by total
  abundances when <code>weighted = TRUE</code>) (see Almeida-Neto et
  al. 2008). With <code>weighted = TRUE</code>, the function finds the
  weighted version of the index (Almeida-Neto &amp; Ulrich,
  2011). However, this requires quantitative null models for adequate
  testing. Almeida-Neto &amp; Ulrich (2011) say that you have positive
  nestedness if values in the first row/column are higher than in the
  second.  With this condition, weighted analysis of binary data will
  always give zero nestedness. With argument <code>wbinary = TRUE</code>,
  equality of rows/columns also indicates nestedness, and binary data
  will give identical results in weighted and unweighted analysis.
  However, this can also influence the results of weighted analysis so
  that the results may differ from Almeida-Neto &amp; Ulrich (2011).</p>
<p>Functions <code>nestedbetasor</code> and <code>nestedbetajac</code> find
  multiple-site dissimilarities and decompose these into components of
  turnover and nestedness following Baselga (2012); the pairwise
  dissimilarities can be found with <code><a href="designdist.html">designdist</a></code>. This can
  be seen as a decomposition of beta diversity (see
  <code><a href="betadiver.html">betadiver</a></code>).  Function <code>nestedbetasor</code> uses
  Sørensen dissimilarity and the turnover component is
  Simpson dissimilarity (Baselga 2012), and <code>nestedbetajac</code> uses
  analogous methods with the Jaccard index. The functions return a
  vector of three items: turnover, nestedness and their sum which is
  the multiple Sørensen or Jaccard dissimilarity. The
  last one is the total beta diversity (Baselga 2012). The functions
  will treat data as presence/absence (binary) and they can be used
  with binary <code><a href="nullmodel.html">nullmodel</a></code>. The overall dissimilarity is
  constant in all <code><a href="nullmodel.html">nullmodel</a></code>s that fix species (column)
  frequencies (<code>"c0"</code>), and all components are constant if row
  columns are also fixed (e.g., model <code>"quasiswap"</code>), and the
  functions are not meaningful with these null models.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>The result returned by a nestedness function contains an item called
<code>statistic</code>, but the other components differ among functions. The
  functions are constructed so that they can be handled by
<code><a href="oecosimu.html">oecosimu</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Almeida-Neto, M., Guimarães, P.,
  Guimarães, P.R., Loyola, R.D. &amp; Ulrich, W. (2008). A
  consistent metric for nestedness analysis in ecological systems:
  reconciling concept and measurement. <em>Oikos</em> 117, 1227--1239.</p>
<p>Almeida-Neto, M. &amp; Ulrich, W. (2011). A straightforward
  computational approach for measuring nestedness using quantitative
  matrices. <em>Env. Mod. Software</em> 26, 173--178.</p>
<p>Atmar, W. &amp; Patterson, B.D. (1993). The measurement of order and
  disorder in the distribution of species in fragmented
  habitat. <em>Oecologia</em> 96, 373--382.</p>
<p>Baselga, A. (2012). The relationship between species replacement,
  dissimilarity derived from nestedness, and nestedness. <em>Global
  Ecol. Biogeogr.</em> 21, 1223--1232.</p>
<p>Brualdi, R.A. &amp; Sanderson, J.G. (1999). Nested species subsets, gaps,
  and discrepancy. <em>Oecologia</em> 119, 256--264.</p>
<p>Patterson, B.D. &amp; Atmar, W. (1986). Nested subsets and the structure
  of insular mammalian faunas and archipelagos. <em>Biol. J. Linnean
    Soc.</em> 28, 65--82.</p>
<p>Rodríguez-Gironés, M.A.  &amp; Santamaria, L.
  (2006). A new algorithm to calculate the nestedness temperature of
  presence-absence matrices. <em>J. Biogeogr.</em> 33, 924--935.</p>
<p>Stone, L. &amp; Roberts, A. (1990). The checkerboard score and species
  distributions. <em>Oecologia</em> 85, 74--79.</p>
<p>Wright, D.H., Patterson, B.D., Mikkelson, G.M., Cutler, A. &amp; Atmar,
  W. (1998). A comparative analysis of nested subset patterns of species
  composition. <em>Oecologia</em> 113, 1--20.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jari Oksanen and Gustavo Carvalho (<code>nestednodf</code>).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>In general, the functions should be used with <code><a href="oecosimu.html">oecosimu</a></code>
  which generates Null model communities to assess the non-randomness of
  nestedness patterns.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sipoo</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Matrix temperature</span></span>
<span class="r-in"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">nestedtemp</span><span class="op">(</span><span class="va">sipoo</span><span class="op">)</span></span>
<span class="r-in"><span class="va">out</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nestedness temperature: 10.23234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> with matrix fill 0.2233333 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span class="r-plt img"><img src="nestedtemp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, kind<span class="op">=</span><span class="st">"incid"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="nestedtemp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co">## Use oecosimu to assess the non-randomness of checker board units</span></span>
<span class="r-in"><span class="fu">nestedchecker</span><span class="op">(</span><span class="va">sipoo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checkerboard Units    : 2767 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C-score (species mean): 2.258776 </span>
<span class="r-in"><span class="fu"><a href="oecosimu.html">oecosimu</a></span><span class="op">(</span><span class="va">sipoo</span>, <span class="va">nestedchecker</span>, <span class="st">"quasiswap"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oecosimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: oecosimu(comm = sipoo, nestfun = nestedchecker, method =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "quasiswap")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘quasiswap’ with 99 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checkerboard Units    : 2767 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C-score (species mean): 2.258776 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               statistic     SES   mean   2.5%    50%  97.5% Pr(sim.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> checkerboards      2767 0.66774 2704.3 2551.2 2695.0 2919.2     0.41</span>
<span class="r-in"><span class="co">## Another Null model and standardized checkerboard score</span></span>
<span class="r-in"><span class="fu"><a href="oecosimu.html">oecosimu</a></span><span class="op">(</span><span class="va">sipoo</span>, <span class="va">nestedchecker</span>, <span class="st">"r00"</span>, statistic <span class="op">=</span> <span class="st">"C.score"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> oecosimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: oecosimu(comm = sipoo, nestfun = nestedchecker, method = "r00",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> statistic = "C.score")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r00’ with 99 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checkerboard Units    : 2767 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C-score (species mean): 2.258776 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES   mean   2.5%    50%  97.5% Pr(sim.)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C.score    2.2588 -26.183 9.1901 8.6081 9.1682 9.7058     0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

