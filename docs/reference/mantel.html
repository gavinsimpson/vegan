<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Mantel and Partial Mantel Tests for Dissimilarity Matrices — mantel • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Mantel and Partial Mantel Tests for Dissimilarity Matrices — mantel"><meta property="og:description" content="Function mantel  finds the Mantel statistic as a matrix
  correlation between two dissimilarity matrices, and function
  mantel.partial finds the partial Mantel statistic as the
  partial matrix correlation between three dissimilarity matrices.  The
  significance of the statistic is evaluated by permuting rows and
  columns of the first dissimilarity matrix."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mantel and Partial Mantel Tests for Dissimilarity Matrices</h1>
    
    <div class="hidden name"><code>mantel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>mantel</code>  finds the Mantel statistic as a matrix
  correlation between two dissimilarity matrices, and function
  <code>mantel.partial</code> finds the partial Mantel statistic as the
  partial matrix correlation between three dissimilarity matrices.  The
  significance of the statistic is evaluated by permuting rows and
  columns of the first dissimilarity matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mantel</span><span class="op">(</span><span class="va">xdis</span>, <span class="va">ydis</span>, method<span class="op">=</span><span class="st">"pearson"</span>, permutations<span class="op">=</span><span class="fl">999</span>, strata <span class="op">=</span> <span class="cn">NULL</span>,
    na.rm <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">mantel.partial</span><span class="op">(</span><span class="va">xdis</span>, <span class="va">ydis</span>, <span class="va">zdis</span>, method <span class="op">=</span> <span class="st">"pearson"</span>, permutations <span class="op">=</span> <span class="fl">999</span>, 
    strata <span class="op">=</span> <span class="cn">NULL</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xdis, ydis, zdis</dt>
<dd><p>Dissimilarity matrices or<code>dist</code>
    objects. The first object <code>xdis</code> will be permuted in
    permutation tests.</p></dd>
<dt>method</dt>
<dd><p>Correlation method, as accepted by <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>:
    <code>"pearson"</code>, <code>"spearman"</code> or <code>"kendall"</code>.</p></dd>
<dt>permutations</dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices.</p></dd>
<dt>strata</dt>
<dd><p>An integer vector or factor specifying the strata for
    permutation. If supplied, observations are permuted only within the
    specified strata.</p></dd>
<dt>na.rm</dt>
<dd><p>Remove missing values in calculation of Mantel
    correlation. Use this option with care: Permutation tests can
    be biased, in particular if two matrices had missing values in
    matching positions.</p></dd>
<dt>parallel</dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Mantel statistic is simply a correlation between entries of two
  dissimilarity matrices (some use cross products, but these are
  linearly related).  However, the significance cannot be directly
  assessed, because there are \(N(N-1)/2\) entries for just \(N\)
  observations.  Mantel developed asymptotic test, but here we use
  permutations of \(N\) rows and columns of dissimilarity
  matrix. Only the first matrix (<code>xdist</code>) will be permuted, and
  the second is kept constant. See <code><a href="permutations.html">permutations</a></code> for
  additional details on permutation tests in Vegan.</p>
<p>Partial Mantel statistic uses partial correlation
  conditioned on the third matrix. Only the first matrix is permuted so
  that the correlation structure between second and first matrices is
  kept constant. Although <code>mantel.partial</code> silently accepts other
  methods than <code>"pearson"</code>, partial correlations will probably be
  wrong with other methods.</p>
<p>The function uses <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>, which should accept
  alternatives <code>pearson</code> for product moment correlations and
  <code>spearman</code> or <code>kendall</code> for rank correlations.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a list of class <code>mantel</code> with following
  components:</p>
<dl><dt>Call </dt>
<dd><p>Function call.</p></dd>
<dt>method </dt>
<dd><p>Correlation method used, as returned by
    <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code>.</p></dd>
<dt>statistic</dt>
<dd><p>The Mantel statistic.</p></dd>
<dt>signif</dt>
<dd><p>Empirical significance level from permutations.</p></dd>
<dt>perm</dt>
<dd><p>A vector of permuted values. The distribution of
    permuted values can be inspected with <code><a href="permustats.html">permustats</a></code> 
    function.</p></dd>
<dt>permutations</dt>
<dd><p>Number of permutations.</p></dd>
<dt>control</dt>
<dd><p>A list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>.</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>The test is due to Mantel, of course, but the
  current implementation is based on Legendre and Legendre.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  Edition. Elsevier.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Legendre &amp; Legendre (2012, Box 10.4) warn against using partial
  Mantel correlations.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jari Oksanen</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code> for correlation coefficients,
  <code><a href="procrustes.html">protest</a></code> (Procrustes test) for an alternative with
  ordination diagrams, <code><a href="anosim.html">anosim</a></code>  and <code><a href="mrpp.html">mrpp</a></code>
  for comparing dissimilarities against 
  classification.  For dissimilarity matrices, see <code><a href="vegdist.html">vegdist</a></code>
  or <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>.  See <code><a href="bioenv.html">bioenv</a></code> for selecting
  environmental variables.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Is vegetation related to environment?</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span>
<span class="r-in"><span class="va">veg.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span> <span class="co"># Bray-Curtis</span></span>
<span class="r-in"><span class="va">env.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span>, <span class="st">"euclid"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">mantel</span><span class="op">(</span><span class="va">veg.dist</span>, <span class="va">env.dist</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mantel statistic based on Pearson's product-moment correlation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mantel(xdis = veg.dist, ydis = env.dist) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mantel statistic r: 0.3047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Significance: 0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper quantiles of permutations (null model):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   90%   95% 97.5%   99% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.107 0.149 0.178 0.212 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mantel</span><span class="op">(</span><span class="va">veg.dist</span>, <span class="va">env.dist</span>, method<span class="op">=</span><span class="st">"spear"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mantel statistic based on Spearman's rank correlation rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mantel(xdis = veg.dist, ydis = env.dist, method = "spear") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mantel statistic r: 0.2838 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Significance: 0.002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper quantiles of permutations (null model):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   90%   95% 97.5%   99% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.119 0.147 0.181 0.213 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

