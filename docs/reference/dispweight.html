<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dispersion-based weighting of species counts — dispweight • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Dispersion-based weighting of species counts — dispweight"><meta property="og:description" content="Transform abundance data downweighting species that are 
  overdispersed to the Poisson error."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dispersion-based weighting of species counts</h1>
    
    <div class="hidden name"><code>dispweight.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform abundance data downweighting species that are 
  overdispersed to the Poisson error.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dispweight</span><span class="op">(</span><span class="va">comm</span>, <span class="va">groups</span>, nsimul <span class="op">=</span> <span class="fl">999</span>, nullmodel <span class="op">=</span> <span class="st">"c0_ind"</span>,
    plimit <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="fu">gdispweight</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, plimit <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co"># S3 method for dispweight</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>comm</dt>
<dd><p>Community data matrix.</p></dd>
<dt>groups</dt>
<dd><p>Factor describing the group structure. If missing, all 
     sites are regarded as belonging to one group. <code>NA</code> values are 
     not allowed.</p></dd>
<dt>nsimul</dt>
<dd><p>Number of simulations.</p></dd>
<dt>nullmodel</dt>
<dd><p>The <code><a href="nullmodel.html">nullmodel</a></code> used in
    <code><a href="commsim.html">commsim</a></code> within <code>groups</code>. The default
    follows Clarke et al. (2006).</p></dd>
<dt>plimit</dt>
<dd><p>Downweight species if their \(p\)-value is at or
     below this limit.</p></dd>
<dt>formula, data</dt>
<dd><p>Formula where the left-hand side is the
    community data frame and right-hand side gives the explanatory
    variables. The explanatory variables are found in the data frame
    given in <code>data</code> or in the parent frame.</p></dd>
<dt>object</dt>
<dd><p>Result object from <code>dispweight</code> or
    <code>gdispweight</code>.</p></dd>
<dt>...</dt>
<dd><p>Other parameters passed to functions.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>The dispersion index (\(D\)) is calculated as ratio between variance
and expected value for each species.  If the species abundances follow
Poisson distribution, expected dispersion is \(E(D) = 1\), and if
\(D &gt; 1\), the species is overdispersed. The inverse \(1/D\) can
be used to downweight species abundances.  Species are only
downweighted when overdispersion is judged to be statistically
significant (Clarke et al. 2006).</p>
<p>Function <code>dispweight</code> implements the original procedure of Clarke
et al. (2006). Only one factor can be used to group the sites and to
find the species means. The significance of overdispersion is assessed
freely distributing individuals of each species within factor
levels. This is achieved by using <code><a href="nullmodel.html">nullmodel</a></code>
<code>"c0_ind"</code> (which accords to Clarke et al. 2006), but other
nullmodels can be used, though they may not be meaningful (see
<code><a href="commsim.html">commsim</a></code> for alternatives). If a species is absent in
some factor level, the whole level is ignored in calculation of
overdispersion, and the number of degrees of freedom can vary among
species. The reduced number of degrees of freedom is used as a divisor
for overdispersion \(D\), and such species have higher dispersion
and hence lower weights in transformation.</p>
<p>Function <code>gdispweight</code> is a generalized parametric version of
<code>dispweight</code>. The function is based on <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> with
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasipoisson</a></code> error <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code>. Any
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> model can be used, including several factors or
continuous covariates. Function <code>gdispweight</code> uses the same test
statistic as <code>dispweight</code> (Pearson Chi-square), but it does not
ignore factor levels where species is absent, and the number of
degrees of freedom is equal for all species. Therefore transformation
weights can be higher than in <code>dispweight</code>. The
<code>gdispweight</code> function evaluates the significance of
overdispersion parametrically from Chi-square distribution
(<code><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></code>).</p>
<p>Functions <code>dispweight</code> and <code>gdispweight</code> transform data, but
they add information on overdispersion and weights as attributes of
the result. The <code>summary</code> can be used to extract and print that
information.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Function returns transformed data with the following new attributes:</p>
<dl><dt>D</dt>
<dd><p>Dispersion statistic.</p></dd>
<dt>df</dt>
<dd><p>Degrees of freedom for each species.</p></dd>
<dt>p</dt>
<dd><p>\(p\)-value of the Dispersion statistic \(D\).</p></dd>
<dt>weights</dt>
<dd><p>weights applied to community data.</p></dd>
<dt>nsimul</dt>
<dd><p>Number of simulations used to assess the \(p\)-value,
      or <code>NA</code> when simulations were not performed.</p></dd>
<dt>nullmodel</dt>
<dd><p>The name of <code><a href="commsim.html">commsim</a></code> null model, or
      <code>NA</code> when simulations were not performed.</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Clarke, K. R., M. G. Chapman, P. J. Somerfield, and
H. R. Needham. 2006. Dispersion-based weighting of species counts in
assemblage analyses. <em>Marine Ecology Progress Series</em>, 320,
11–27.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Eduard Szöcs <a href="mailto:eduardszoesc@gmail.com">eduardszoesc@gmail.com</a> wrote the original
  <code>dispweight</code>, Jari Oksanen significantly modified the code,
  provided support functions and developed <code>gdispweight</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span>, <span class="va">mite.env</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## dispweight and its summary</span></span>
<span class="r-in"><span class="va">mite.dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.env</span>, <span class="fu">dispweight</span><span class="op">(</span><span class="va">mite</span>, <span class="va">Shrub</span>, nsimul <span class="op">=</span> <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mite.dw</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dispersion    Weight Df Pr(Disp.)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brachy       9.6908 0.1031909 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PHTH         3.2809 0.3047900 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HPAV         6.5263 0.1532264 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RARD         6.0477 0.1653525 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSTR         2.2619 0.4421053 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Protopl      5.4229 0.1844031 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MEGR         4.5354 0.2204860 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MPRO         1.2687 0.7882353 67      0.04 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVIE         2.5956 0.3852706 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HMIN        10.0714 0.0992906 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HMIN2        7.5674 0.1321466 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NPRA         2.6743 0.3739344 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVEL         9.6295 0.1038474 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ONOV        11.3628 0.0880064 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SUCT         8.7372 0.1144533 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LCIL       129.4436 0.0077254 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Oribatl1     4.1250 0.2424248 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ceratoz1     1.7150 0.5830768 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PWIL         2.2943 0.4358538 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Galumna1     2.8777 0.3474943 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stgncrs2     3.8242 0.2614953 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HRUF         1.7575 0.5690021 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trhypch1    14.9225 0.0670128 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PPEL         1.3628 0.7337770 49      0.04 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NCOR         2.5875 0.3864771 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLAT         2.7857 0.3589744 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FSET         4.8901 0.2044944 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lepidzts     1.6577 0.6032360 49      0.04 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eupelops     1.4611 0.6844033 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Miniglmn     1.6505 0.6058733 49      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LRUG        12.0658 0.0828790 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PLAG2        3.2403 0.3086090 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ceratoz3     3.5125 0.2846947 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Oppiminu     3.1680 0.3156525 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trimalc2    10.5927 0.0944046 67      0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on 99 simulations on 'c0_ind' nullmodel</span>
<span class="r-in"><span class="co">## generalized dispersion weighting</span></span>
<span class="r-in"><span class="va">mite.dw</span> <span class="op">&lt;-</span> <span class="fu">gdispweight</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="va">Shrub</span> <span class="op">+</span> <span class="va">WatrCont</span>, data <span class="op">=</span> <span class="va">mite.env</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">mite.dw</span> <span class="op">~</span> <span class="va">Shrub</span> <span class="op">+</span> <span class="va">WatrCont</span>, data <span class="op">=</span> <span class="va">mite.env</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = mite.dw ~ Shrub + WatrCont, data = mite.env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         38.1640     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    9.2129     0.2414    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 28.9511     0.7586   35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  RDA1  RDA2  RDA3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.986 0.748 0.480 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.886 3.634 2.791 2.592 1.932 1.573 1.210 1.078 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 35 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

