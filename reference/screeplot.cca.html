<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca"><meta property="og:description" content="Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for princomp and prcomp."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Screeplots for Ordination Results and Broken Stick Distributions</h1>
    
    <div class="hidden name"><code>screeplot.cca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code> and <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for cca</span>
<span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,
         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">)</span> <span class="op">||</span> <span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">$</span><span class="va">rank</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">CA</span><span class="op">$</span><span class="va">rank</span> <span class="kw">else</span> <span class="va">x</span><span class="op">$</span><span class="va">CCA</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span>,
         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,
         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,
         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,
         <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for decorana</span>
<span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,
         npcs <span class="op">=</span> <span class="fl">4</span>,
         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,
         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,
         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,
         <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for prcomp</span>
<span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,
         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,
         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,
         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,
         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,
         <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for princomp</span>
<span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">x</span>, bstick <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barplot"</span>, <span class="st">"lines"</span><span class="op">)</span>,
         npcs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span>,
         ptype <span class="op">=</span> <span class="st">"o"</span>, bst.col <span class="op">=</span> <span class="st">"red"</span>, bst.lty <span class="op">=</span> <span class="st">"solid"</span>,
         xlab <span class="op">=</span> <span class="st">"Component"</span>, ylab <span class="op">=</span> <span class="st">"Inertia"</span>,
         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, legend <span class="op">=</span> <span class="va">bstick</span>,
         <span class="va">...</span><span class="op">)</span>

<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, tot.var <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for cca</span>
<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for prcomp</span>
<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for princomp</span>
<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for decorana</span>
<span class="fu">bstick</span><span class="op">(</span><span class="va">n</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>an object from which the component variances can be determined.</p></dd>
<dt>bstick</dt>
<dd><p>logical; should the broken stick distribution be drawn?</p></dd>
<dt>npcs</dt>
<dd><p>the number of components to be plotted.</p></dd>
<dt>type</dt>
<dd><p>the type of plot.</p></dd>
<dt>ptype</dt>
<dd><p>if <code>type == "lines"</code> or <code>bstick = TRUE</code>, a
    character indicating the type of plotting used for the lines;
    actually any of the <code>type</code>s as in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code>.</p></dd>
<dt>bst.col, bst.lty</dt>
<dd><p>the colour and line type used to draw the
    broken stick distribution.</p></dd>
<dt>xlab, ylab, main</dt>
<dd><p>graphics parameters.</p></dd>
<dt>legend</dt>
<dd><p>logical; draw a legend?</p></dd>
<dt>n</dt>
<dd><p>an object from which the variances can be extracted or the
    number of variances (components) in the case of
    <code>bstick.default</code>.</p></dd>
<dt>tot.var</dt>
<dd><p>the total variance to be split.</p></dd>
<dt>...</dt>
<dd><p>arguments passed to other methods.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The functions provide screeplots for most ordination methods in
  <span class="pkg">vegan</span> and enhanced versions with broken stick for
  <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code> and <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code>.</p>
<p>Function <code>bstick</code> gives the brokenstick values which are ordered
  random proportions, defined as  \(p_i = (tot/n) \sum_{x=i}^n 
    (1/x)\) (Legendre &amp; Legendre 2012), where
  \(tot\) is the total  and \(n\) is the number of brokenstick
  components (cf. <code><a href="radfit.html">radfit</a></code>).  Broken stick has
  been recommended as a stopping rule in principal component analysis
  (Jackson 1993): principal components should be retained as long as
  observed eigenvalues are higher than corresponding random broken stick
  components.</p>
<p>The <code>bstick</code> function is generic. The default needs the number of
  components and the total, and specific methods extract this
  information from ordination results.  There also is a <code>bstick</code>
  method for <code><a href="cca.html">cca</a></code>.  However, the broken stick model is not
  strictly valid for correspondence analysis (CA), because eigenvalues
  of CA are defined to be \(\leq 1\), whereas brokenstick
  components have no such restrictions. The brokenstick components are not
  available for <code><a href="decorana.html">decorana</a></code> where the sum of eigenvalues
  (total inertia) is unknown, and the eigenvalues of single axes are not
  additive in detrended analysis.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Function <code>screeplot</code> draws a plot on the currently active device, 
  and returns invisibly the <code><a href="https://rdrr.io/r/grDevices/xy.coords.html" class="external-link">xy.coords</a></code> of the points or
  bars for the eigenvalues.
  Function <code>bstick</code> returns a numeric vector of broken stick
  components.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Jackson, D. A. (1993). Stopping rules in principal components
  analysis: a comparison of heuristical and statistical
  approaches. <em>Ecology</em> 74, 2204--2214.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  ed. Elsevier.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gavin L. Simpson</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cca.html">cca</a></code>, <code><a href="decorana.html">decorana</a></code>, <code><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></code> and
  <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></code> for the ordination functions, and
  <code><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></code> for the stock version.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vare.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="cca.html">rda</a></span><span class="op">(</span><span class="va">varespec</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">bstick</span><span class="op">(</span><span class="va">vare.pca</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC1       PC2       PC3       PC4       PC5       PC6       PC7       PC8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.1438620 5.2308185 4.2742968 3.6366156 3.1583548 2.7757461 2.4569055 2.1836136 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PC9      PC10      PC11      PC12      PC13      PC14      PC15      PC16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.9444831 1.7319228 1.5406184 1.3667054 1.2072851 1.0601279 0.9234819 0.7959457 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PC17      PC18      PC19      PC20      PC21      PC22      PC23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6763805 0.5638485 0.4575683 0.3568818 0.2612296 0.1701323 0.0831758 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">vare.pca</span>, bstick <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"lines"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="screeplot.cca-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

