<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Additive Diversity Partitioning and Hierarchical Null Model Testing — adipart • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Additive Diversity Partitioning and Hierarchical Null Model Testing — adipart"><meta property="og:description" content="In additive diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set (gamma diversity).
In hierarchical null model testing, a statistic returned by a function is evaluated
according to a nested hierarchical sampling design (hiersimu)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Additive Diversity Partitioning and Hierarchical Null Model Testing</h1>
    
    <div class="hidden name"><code>adipart.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In additive diversity partitioning, mean values of alpha diversity at lower levels of a sampling
hierarchy are compared to the total diversity in the entire data set (gamma diversity).
In hierarchical null model testing, a statistic returned by a function is evaluated
according to a nested hierarchical sampling design (<code>hiersimu</code>).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">adipart</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for default</span>
<span class="fu">adipart</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span>,
    weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unif"</span>, <span class="st">"prop"</span><span class="op">)</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,
    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for formula</span>
<span class="fu">adipart</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span>,
    weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unif"</span>, <span class="st">"prop"</span><span class="op">)</span>, relative <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,
    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">hiersimu</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for default</span>
<span class="fu">hiersimu</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, <span class="va">FUN</span>, location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span><span class="op">)</span>,
    relative <span class="op">=</span> <span class="cn">FALSE</span>, drop.highest <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,
    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for formula</span>
<span class="fu">hiersimu</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">FUN</span>, location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span><span class="op">)</span>,
    relative <span class="op">=</span> <span class="cn">FALSE</span>, drop.highest <span class="op">=</span> <span class="cn">FALSE</span>, nsimul<span class="op">=</span><span class="fl">99</span>,
    method <span class="op">=</span> <span class="st">"r2dtable"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>A community matrix.</p></dd>
<dt>x</dt>
<dd><p>A matrix with same number of rows as in <code>y</code>, columns
    coding the levels of sampling hierarchy. The number of groups within
    the hierarchy must decrease from left to right. If <code>x</code> is missing,
    function performs an overall decomposition into alpha, beta and
    gamma diversities.</p></dd>
<dt>formula</dt>
<dd><p>A two sided model formula in the form <code>y ~ x</code>,
    where <code>y</code> is the community data matrix with samples as rows and
    species as column. Right hand side (<code>x</code>) must be grouping variables
    referring to levels of sampling hierarchy, terms from right to left
    will be treated as nested (first column is the lowest, last is the
    highest level). The formula will add a unique indentifier to rows and
    constant for the rows to always produce estimates of row-level alpha
    and overall gamma diversities. You must use non-formula
    interface to avoid this behaviour. Interaction terms are
    not allowed.</p></dd>
<dt>data</dt>
<dd><p>A data frame where to look for variables defined in the
    right hand side of <code>formula</code>. If missing, variables are looked
    in the global environment.</p></dd>
<dt>index</dt>
<dd><p>Character, the diversity index to be calculated (see Details).</p></dd>
<dt>weights</dt>
<dd><p>Character, <code>"unif"</code> for uniform weights,
    <code>"prop"</code> for weighting proportional to sample abundances to use
    in weighted averaging of individual alpha values within strata of a
    given level of the sampling hierarchy.</p></dd>
<dt>relative</dt>
<dd><p>Logical, if <code>TRUE</code> then alpha and beta diversity
    values are given relative to the value of gamma for function
    <code>adipart</code>.</p></dd>
<dt>nsimul</dt>
<dd><p>Number of permutations to use.  If <code>nsimul = 0</code>,
    only the <code>FUN</code> argument is evaluated.
    It is thus possible to reuse the statistic values
    without a null model.</p></dd>
<dt>method</dt>
<dd><p>Null model method: either a name (character string) of
    a method defined in <code><a href="commsim.html">make.commsim</a></code> or a
    <code><a href="commsim.html">commsim</a></code> function.
    The default <code>"r2dtable"</code> keeps row sums and column sums fixed.
    See <code><a href="oecosimu.html">oecosimu</a></code> for Details and Examples.</p></dd>
<dt>FUN</dt>
<dd><p>A function to be used by <code>hiersimu</code>. This must be
    fully specified, because currently other arguments cannot be passed
    to this function via <code>...</code>.</p></dd>
<dt>location</dt>
<dd><p>Character, identifies which function (mean or median)
    is to be used to calculate location of the samples.</p></dd>
<dt>drop.highest</dt>
<dd><p>Logical, to drop the highest level or not. When
    <code>FUN</code> evaluates only arrays with at least 2 dimensions, highest
    level should be dropped, or not selected at all.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed to functions, e.g. base of
    logarithm for Shannon diversity, or <code>method</code>, <code>thin</code> or
    <code>burnin</code> arguments for <code><a href="oecosimu.html">oecosimu</a></code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>Additive diversity partitioning means that mean alpha and beta
  diversities add up to gamma diversity, thus beta diversity is measured
  in the same dimensions as alpha and gamma (Lande 1996). This additive
  procedure is then extended across multiple scales in a hierarchical
  sampling design with \(i = 1, 2, 3, \ldots, m\) levels of sampling
  (Crist et al. 2003). Samples in lower hierarchical levels are nested
  within higher level units, thus from \(i=1\) to \(i=m\) grain size
  is increasing under constant survey extent. At each level \(i\),
  \(\alpha_i\) denotes average diversity found within samples.</p>
<p>At the highest sampling level, the diversity components are calculated
  as $$\beta_m  = \gamma -  \alpha_m$$ For
  each  lower   sampling  level   as  $$\beta_i  =   \alpha_{i+1}  -
  \alpha_i$$ Then,  the additive partition
  of diversity is $$\gamma  = \alpha_1 + \sum_{i=1}^m \beta_i$$</p>
<p>Average alpha components can be weighted uniformly
  (<code>weight="unif"</code>) to calculate it as simple average, or
  proportionally to sample abundances (<code>weight="prop"</code>) to
  calculate it as weighted average as follows $$\alpha_i =
  \sum_{j=1}^{n_i} D_{ij} w_{ij}$$ where
  \(D_{ij}\) is the diversity index and \(w_{ij}\) is the weight
  calculated for the \(j\)th sample at the \(i\)th sampling level.</p>
<p>The implementation of additive diversity partitioning in
  <code>adipart</code> follows Crist et al. 2003. It is based on species
  richness (\(S\), not \(S-1\)), Shannon's and Simpson's diversity
  indices stated as the <code>index</code> argument.</p>
<p>The expected diversity components are calculated <code>nsimul</code> times
  by individual based randomisation of the community data matrix. This
  is done by the <code>"r2dtable"</code> method in <code><a href="oecosimu.html">oecosimu</a></code> by
  default.</p>
<p><code>hiersimu</code> works almost in the same way as <code>adipart</code>, but
  without comparing the actual statistic values returned by <code>FUN</code>
  to the highest possible value (cf. gamma diversity).  This is so,
  because in most of the cases, it is difficult to ensure additive
  properties of the mean statistic values along the hierarchy.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"adipart"</code> or <code>"hiersimu"</code> with same
  structure as <code><a href="oecosimu.html">oecosimu</a></code> objects.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Crist,   T.O.,   Veech,    J.A.,   Gering,   J.C.   and   Summerville,
  K.S.  (2003).  Partitioning species  diversity  across landscapes  and
  regions:  a hierarchical  analysis of  \(\alpha\),  \(\beta\), and
  \(\gamma\)-diversity.  <em>Am. Nat.</em>, <b>162</b>, 734--743.</p>
<p>Lande, R.  (1996). Statistics and partitioning of species diversity,
  and similarity among multiple communities.  <em>Oikos</em>, <b>76</b>,
  5--13.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    

<p>Péter Sólymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="oecosimu.html">oecosimu</a></code> for permutation settings and
  calculating \(p\)-values. <code><a href="multipart.html">multipart</a></code> for multiplicative
  diversity partitioning.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## NOTE: 'nsimul' argument usually needs to be &gt;= 99</span></span>
<span class="r-in"><span class="co">## here much lower value is used for demonstration</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Function to get equal area partitions of the mite data</span></span>
<span class="r-in"><span class="va">cutter</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">cut</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cut</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">out</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">cut</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">cut</span><span class="op">[</span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span></span>
<span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-in"><span class="co">## The hierarchy of sample aggregation</span></span>
<span class="r-in"><span class="va">levsm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span class="r-in">    l1<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>,</span>
<span class="r-in">    l2<span class="op">=</span><span class="fu">cutter</span><span class="op">(</span><span class="va">y</span>, cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">    l3<span class="op">=</span><span class="fu">cutter</span><span class="op">(</span><span class="va">y</span>, cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">    l4<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Let's see in a map</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l1"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l2"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mite.xy</span>, main<span class="op">=</span><span class="st">"l3"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">levsm</span><span class="op">$</span><span class="va">l3</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="adipart-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Additive diversity partitioning</span></span>
<span class="r-in"><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(y = mite, index = "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES   mean   2.5%    50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -46.372 22.335 22.034 22.300 22.557     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.000 35.000 35.000 35.000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     19.886  46.372 12.665 12.443 12.700 12.966     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">## the next two define identical models</span></span>
<span class="r-in"><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span>, <span class="va">levsm</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(y = mite, x = levsm, index = "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES     mean     2.5%      50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -33.686 22.34662 22.01643 22.32857 22.674     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.2    29.750 -31.013 34.81579 34.50000 34.75000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.3    33.000   0.000 35.00000 35.00000 35.00000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.000 35.00000 35.00000 35.00000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     14.636   6.788 12.46917 12.02821 12.42143 12.922     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.2      3.250  18.769  0.18421  0.00000  0.25000  0.500     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.3      2.000   0.000  0.00000  0.00000  0.00000  0.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="fu">adipart</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="va">l2</span> <span class="op">+</span> <span class="va">l3</span>, <span class="va">levsm</span>, index<span class="op">=</span><span class="st">"richness"</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adipart object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: adipart(formula = mite ~ l2 + l3, data = levsm, index =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "richness", nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> options:  index richness, weights unif</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES      mean      2.5%       50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.1    15.114 -45.449 22.322556 22.095714 22.300000 22.645     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.2    29.750 -33.904 34.894737 34.612500 35.000000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha.3    33.000 -17.206 34.973684 34.725000 35.000000 35.000     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma      35.000   0.000 35.000000 35.000000 35.000000 35.000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.1     14.636  11.597 12.572180 12.290714 12.607143 12.831     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.2      3.250  26.560  0.078947  0.000000  0.000000  0.250     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta.3      2.000  17.206  0.026316  0.000000  0.000000  0.275     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">## Hierarchical null model testing</span></span>
<span class="r-in"><span class="co">## diversity analysis (similar to adipart)</span></span>
<span class="r-in"><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span>, FUN<span class="op">=</span><span class="va">diversity</span>, relative<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(y = mite, FUN = diversity, relative = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         statistic     SES    mean    2.5%     50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> level_1   0.76064 -59.091 0.93855 0.93248 0.93820 0.9425     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leve_2    1.00000   0.000 1.00000 1.00000 1.00000 1.0000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span> <span class="va">l2</span> <span class="op">+</span> <span class="va">l3</span>, <span class="va">levsm</span>, FUN<span class="op">=</span><span class="va">diversity</span>, relative<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(formula = mite ~ l2 + l3, data = levsm, FUN = diversity,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> relative = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      statistic      SES    mean    2.5%     50%  97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unit   0.76064  -60.717 0.93897 0.93477 0.93800 0.9445     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l2     0.89736 -153.694 0.99787 0.99676 0.99804 0.9988     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l3     0.92791 -561.529 0.99936 0.99918 0.99937 0.9995     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> all    1.00000    0.000 1.00000 1.00000 1.00000 1.0000     1.00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">## Hierarchical testing with the Morisita index</span></span>
<span class="r-in"><span class="va">morfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="dispindmorisita.html">dispindmorisita</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">imst</span></span>
<span class="r-in"><span class="fu">hiersimu</span><span class="op">(</span><span class="va">mite</span> <span class="op">~</span><span class="va">.</span>, <span class="va">levsm</span>, <span class="va">morfun</span>, drop.highest<span class="op">=</span><span class="cn">TRUE</span>, nsimul<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hiersimu object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: hiersimu(formula = mite ~ ., data = levsm, FUN = morfun,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> drop.highest = TRUE, nsimul = 19)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nullmodel method ‘r2dtable’ with 19 simulations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: statistic is less or greater than simulated values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    statistic     SES      mean      2.5%       50%   97.5% Pr(sim.)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l1   0.52070  5.6496  0.365853  0.334568  0.356153  0.4226     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l2   0.60234 11.5615  0.166932  0.098654  0.181426  0.2112     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> l3   0.67509 17.8628 -0.175050 -0.266788 -0.165749 -0.0983     0.05 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

