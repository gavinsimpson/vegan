<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multi Response Permutation Procedure and Mean Dissimilarity Matrix — mrpp • vegan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multi Response Permutation Procedure and Mean Dissimilarity Matrix — mrpp"><meta property="og:description" content="Multiple Response Permutation Procedure (MRPP) provides a
test of whether there is a significant difference between two or more
groups of sampling units. Function meandist finds the mean within
and between block dissimilarities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vegandevs/vegan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi Response Permutation Procedure and Mean Dissimilarity Matrix</h1>
    
    <div class="hidden name"><code>mrpp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Multiple Response Permutation Procedure (MRPP) provides a
test of whether there is a significant difference between two or more
groups of sampling units. Function <code>meandist</code> finds the mean within
and between block dissimilarities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mrpp</span><span class="op">(</span><span class="va">dat</span>, <span class="va">grouping</span>, permutations <span class="op">=</span> <span class="fl">999</span>, distance <span class="op">=</span> <span class="st">"euclidean"</span>,
     weight.type <span class="op">=</span> <span class="fl">1</span>, strata <span class="op">=</span> <span class="cn">NULL</span>, parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">meandist</span><span class="op">(</span><span class="va">dist</span>, <span class="va">grouping</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for meandist</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for meandist</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, kind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dendrogram"</span>, <span class="st">"histogram"</span><span class="op">)</span>,  cluster <span class="op">=</span> <span class="st">"average"</span>, 
     <span class="va">ylim</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dat</dt>
<dd><p>data matrix or data frame in which rows are samples and
    columns are response variable(s), or a dissimilarity object or a
    symmetric square matrix of dissimilarities.</p></dd>
<dt>grouping</dt>
<dd><p>Factor or numeric index for grouping observations.</p></dd>
<dt>permutations</dt>
<dd><p>a list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the
    number of permutations required, or a permutation matrix where each
    row gives the permuted indices. These are used to assess
    the significance of the MRPP statistic, \(delta\).</p></dd>
<dt>distance</dt>
<dd><p>Choice of distance metric that measures the
    dissimilarity between two observations . See <code><a href="vegdist.html">vegdist</a></code> for
    options.  This will be used if <code>dat</code> was not a dissimilarity
    structure of a symmetric square matrix.</p></dd>
<dt>weight.type</dt>
<dd><p>choice of group weights. See Details below for options.</p></dd>
<dt>strata</dt>
<dd><p>An integer vector or factor specifying the strata for
    permutation. If supplied, observations are permuted only within the
    specified strata.</p></dd>
<dt>parallel</dt>
<dd><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></dd>
<dt>dist</dt>
<dd><p>A <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> object of dissimilarities, such as
    produced by functions <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, <code><a href="vegdist.html">vegdist</a></code> or
    <code><a href="designdist.html">designdist</a></code>.</p></dd>
</dl><p>.</p>
<dl><dt>object, x</dt>
<dd><p>A <code>meandist</code> result object.</p></dd>
<dt>kind</dt>
<dd><p>Draw a dendrogram or a histogram; see Details.</p></dd>
<dt>cluster</dt>
<dd><p>A clustering method for the <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>
    function for <code>kind = "dendrogram"</code>. 
    Any <code>hclust</code> method can be used, but perhaps only
    <code>"average"</code> and <code>"single"</code> make sense.</p></dd>
<dt>ylim</dt>
<dd><p>Limits for vertical axes (optional).</p></dd>
<dt>axes</dt>
<dd><p>Draw scale for the vertical axis.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to functions.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>Multiple Response Permutation Procedure (MRPP) provides a test of
  whether there is a significant difference between two or more groups
  of sampling units. This difference may be one of location (differences
  in mean) or one of spread (differences in within-group distance;
  cf. Warton et al. 2012). Function <code>mrpp</code> operates on a
  <code>data.frame</code> matrix where rows are observations and responses
  data matrix. The response(s) may be uni- or multivariate. The method
  is philosophically and mathematically allied with analysis of
  variance, in that it compares dissimilarities within and among
  groups. If two groups of sampling units are really different (e.g. in
  their species composition), then average of the within-group
  compositional dissimilarities ought to be less than the average of the
  dissimilarities between two random collection of sampling units drawn
  from the entire population.</p>
<p>The mrpp statistic \(\delta\) is the overall weighted mean of
  within-group means of the pairwise dissimilarities among sampling
  units. The choice of group weights is currently not clear. The
  <code>mrpp</code> function offers three choices: (1) group size (\(n\)),
  (2) a degrees-of-freedom analogue (\(n-1\)), and (3) a weight that
  is the number of unique distances calculated among \(n\) sampling
  units (\(n(n-1)/2\)).</p>
<p>The <code>mrpp</code> algorithm first calculates all pairwise distances in
  the entire dataset, then calculates \(\delta\). It then permutes the
  sampling units and their associated pairwise distances, and
  recalculates \(\delta\) based on the permuted data. It repeats the
  permutation step <code>permutations</code> times. The significance test is
  the fraction of permuted deltas that are less than the observed delta,
  with a small sample correction. The function also calculates the
  change-corrected within-group agreement \(A = 1 -\delta/E(\delta)\),
  where \(E(\delta)\) is the expected \(\delta\) assessed as the
  average of dissimilarities.</p>
<p>If the first argument <code>dat</code> can be interpreted as
  dissimilarities, they will be used directly. In other cases the
  function treats <code>dat</code> as observations, and uses
  <code><a href="vegdist.html">vegdist</a></code> to find the dissimilarities.  The default
  <code>distance</code> is Euclidean as in the traditional use of the method,
  but other dissimilarities in <code><a href="vegdist.html">vegdist</a></code> also are available.</p>
<p>Function <code>meandist</code> calculates a matrix of mean within-cluster
  dissimilarities (diagonal) and between-cluster dissimilarities
  (off-diagonal elements), and an attribute <code>n</code> of <code>grouping</code>
  counts. Function <code>summary</code> finds the within-class, between-class
  and overall means of these dissimilarities, and the MRPP statistics
  with all <code>weight.type</code> options and the Classification Strength,
  CS (Van Sickle and Hughes, 2000). CS is defined for dissimilarities as
  \(\bar{B} - \bar{W}\), where \(\bar{B}\) is the
  mean between cluster dissimilarity and \(\bar{W}\) is the mean
  within cluster dissimilarity with <code>weight.type = 1</code>. The function
  does not perform significance tests for these statistics, but you must
  use <code>mrpp</code> with appropriate <code>weight.type</code>. There is
  currently no significance test for CS, but <code>mrpp</code> with
  <code>weight.type = 1</code> gives the correct test for \(\bar{W}\)
  and a good approximation for CS.  Function <code>plot</code> draws a
  dendrogram or a histogram of the result matrix based on the
  within-group and between group dissimilarities. The dendrogram is
  found with the method given in the <code>cluster</code> argument using
  function <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>. The terminal segments hang to
  within-cluster dissimilarity. If some of the clusters are more
  heterogeneous than the combined class, the leaf segment are reversed.
  The histograms are based on dissimilarities, but ore otherwise similar
  to those of Van Sickle and Hughes (2000): horizontal line is drawn at
  the level of mean between-cluster dissimilarity and vertical lines
  connect within-cluster dissimilarities to this line.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a list of class mrpp with following items:</p>
<dl><dt>call </dt>
<dd><p>Function call.</p></dd>
<dt>delta </dt>
<dd><p>The overall weighted mean of group mean distances.</p></dd>
<dt>E.delta</dt>
<dd><p>expected delta, under the null hypothesis of no group
    structure. This is the mean of original dissimilarities.</p></dd>
<dt>CS</dt>
<dd><p>Classification strength (Van Sickle and Hughes,
    2000). Currently not implemented and always <code>NA</code>.</p></dd>
<dt>n</dt>
<dd><p>Number of observations in each class.</p></dd>
<dt>classdelta</dt>
<dd><p>Mean dissimilarities within classes. The overall
    \(\delta\) is the weighted average of these values with given
    <code>weight.type</code></p></dd>
</dl><p>.</p>
<dl><dt>Pvalue</dt>
<dd><p>Significance of the test.</p></dd>
<dt>A</dt>
<dd><p>A chance-corrected estimate of the proportion of the distances
    explained by group identity; a value analogous to a coefficient of 
    determination in a linear model.</p></dd>
<dt>distance</dt>
<dd><p>Choice of distance metric used; the "method" entry of
    the dist object.</p></dd>
<dt>weight.type</dt>
<dd><p>The choice of group weights used.</p></dd>
<dt>boot.deltas</dt>
<dd><p>The vector of "permuted deltas," the deltas
    calculated from each of the permuted datasets. The distribution of
    this item can be inspected with <code><a href="permustats.html">permustats</a></code> function.</p></dd>
<dt>permutations</dt>
<dd><p>The number of permutations used.</p></dd>
<dt>control</dt>
<dd><p>A list of control values for the permutations
    as returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>.</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>B. McCune and J. B. Grace. 2002. <em>Analysis of Ecological
  Communities.</em> MjM  Software Design, Gleneden Beach, Oregon, USA.</p>
<p>P. W. Mielke and K. J. Berry. 2001. <em>Permutation Methods: A
  Distance  Function Approach.</em> Springer Series in
  Statistics. Springer.</p>
<p>J. Van Sickle and R. M. Hughes 2000. Classification strengths of
  ecoregions, catchments, and geographic clusters of aquatic vertebrates
  in Oregon. <em>J. N. Am. Benthol. Soc.</em> 19:370--384.</p>
<p>Warton, D.I., Wright, T.W., Wang, Y. 2012. Distance-based multivariate
  analyses confound location and dispersion effects. <em>Methods in
  Ecology and Evolution</em>, 3, 89--101</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>M. Henry H. Stevens <a href="mailto:HStevens@muohio.edu">HStevens@muohio.edu</a> and Jari Oksanen.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This difference may be one of location (differences in mean) or one of
spread (differences in within-group distance). That is, it may find a
significant difference between two groups simply because one of those
groups has a greater dissimilarities among its sampling units. Most
<code>mrpp</code> models can be analysed with <code><a href="adonis.html">adonis2</a></code> which seems
not suffer from the same problems as <code>mrpp</code> and is a more robust
alternative.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anosim.html">anosim</a></code> for a similar test based on ranks, and
  <code><a href="mantel.html">mantel</a></code> for comparing dissimilarities against continuous
  variables, and
  <code><a href="vegdist.html">vegdist</a></code> for obtaining dissimilarities,
  <code><a href="adonis.html">adonis2</a></code> is a more robust alternative in most cases.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dune.env</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dune.mrpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu">mrpp</span><span class="op">(</span><span class="va">dune</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dune.mrpp</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mrpp(dat = dune, grouping = Management) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dissimilarity index: euclidean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weights for groups:  n </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class means and counts:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       BF    HF    NM    SF   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta 10.03 11.08 10.66 12.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n     3     5     6     6    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chance corrected within-group agreement A: 0.1246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on observed delta 11.15 and expected delta 12.74 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance of delta: 0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Save and change plotting parameters</span></span>
<span class="r-in"><span class="va">def.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,nr<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dune.ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"text"</span>, display<span class="op">=</span><span class="st">"sites"</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 0 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 1 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... New best solution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 0.02027156  max resid 0.06496765 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 2 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 2.884302e-05  max resid 9.148394e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 3 stress 0.1192679 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 4 stress 0.1192679 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 5 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... New best solution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 1.722124e-05  max resid 5.532496e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 6 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 7 stress 0.1990349 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 8 stress 0.1922241 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 9 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... New best solution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 7.093173e-06  max resid 2.298683e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 10 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 5.358171e-06  max resid 1.78836e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 11 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 12 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 13 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 14 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 15 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 2.298566e-06  max resid 7.039978e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 16 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 17 stress 0.1192679 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 18 stress 0.1192678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 19 stress 0.1183186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Procrustes: rmse 1.351272e-05  max resid 3.934786e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Similar to previous best</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run 20 stress 0.1809578 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Solution reached</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu"><a href="ordihull.html">ordihull</a></span><span class="op">(</span><span class="va">dune.ord</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.mrpp</span>, <span class="op">{</span></span>
<span class="r-in">  <span class="va">fig.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">boot.deltas</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delta</span>,<span class="va">boot.deltas</span><span class="op">)</span><span class="op">)</span>, </span>
<span class="r-in">                 main<span class="op">=</span><span class="st">"Test of Differences Among Groups"</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">delta</span><span class="op">)</span>; </span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">delta</span>, <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fig.dist</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span>, adj <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span class="r-in">     <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">bold</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1.5</span> <span class="op">)</span>  <span class="op">}</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="mrpp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">def.par</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## meandist</span></span>
<span class="r-in"><span class="va">dune.md</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dune.env</span>, <span class="fu">meandist</span><span class="op">(</span><span class="fu"><a href="vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">dune</span><span class="op">)</span>, <span class="va">Management</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dune.md</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           BF        HF        NM        SF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BF 0.4159972 0.4736637 0.7296979 0.6247169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HF 0.4736637 0.4418115 0.7217933 0.5673664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NM 0.7296979 0.7217933 0.6882438 0.7723367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SF 0.6247169 0.5673664 0.7723367 0.5813015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "meandist" "matrix"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grouping</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BF HF NM SF </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3  5  6  6 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dune.md</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean distances:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Average</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> within groups  0.5746346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> between groups 0.6664172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> overall        0.6456454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         Statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MRPP A weights n        0.1423836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MRPP A weights n-1      0.1339124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MRPP A weights n(n-1)   0.1099842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Classification strength 0.1127012</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dune.md</span><span class="op">)</span></span>
<span class="r-plt img"><img src="mrpp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dune.md</span>, kind<span class="op">=</span><span class="st">"histogram"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="mrpp-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

